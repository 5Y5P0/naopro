@{
    ViewData["Title"] = "Nos services";
    string tvaNonApplicable = "Aucune taxe : TVA non applicable, art. 293B du CGI";
    string fraisInclus = "Coût de la prestation inclu dans le prix négocié";
}

<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.0/mapbox-gl.css' rel='stylesheet' />
<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.2/mapbox-gl-geocoder.css' type='text/css' />

<style>
    /* stylelint-disable selector-list-comma-newline-after */

    .blog-header {
        line-height: 1;
        border-bottom: 1px solid #e5e5e5;
    }

    .blog-header-logo {
        font-family: "Playfair Display", Georgia, "Times New Roman", serif;
        font-size: 2.25rem;
    }

        .blog-header-logo:hover {
            text-decoration: none;
        }

    h1, h2, h3, h4, h5, h6 {
        font-family: "Playfair Display", Georgia, "Times New Roman", serif;
    }

    .display-4 {
        font-size: 2.5rem;
    }

    @@media (min-width: 768px) {
        .display-4 {
            font-size: 3rem;
        }
    }

    .nav-scroller {
        position: relative;
        z-index: 2;
        height: 2.75rem;
        overflow-y: hidden;
    }

        .nav-scroller .nav {
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: nowrap;
            flex-wrap: nowrap;
            padding-bottom: 1rem;
            margin-top: -1px;
            overflow-x: auto;
            text-align: center;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .nav-scroller .nav-link {
            padding-top: .75rem;
            padding-bottom: .75rem;
            font-size: .875rem;
        }

    .card-img-right {
        height: 100%;
        border-radius: 0 3px 3px 0;
    }

    .flex-auto {
        -ms-flex: 0 0 auto;
        flex: 0 0 auto;
    }

    .h-250 {
        height: 250px;
    }

    @@media (min-width: 768px) {
        .h-md-250 {
            height: 250px;
        }
    }

    /*
    * Blog name and description
    */
    .blog-title {
        margin-bottom: 0;
        font-size: 2rem;
        font-weight: 400;
    }

    .blog-description {
        font-size: 1.1rem;
        color: #999;
    }

    @@media (min-width: 40em) {
        .blog-title {
            font-size: 3.5rem;
        }
    }

    /* Pagination */
    .blog-pagination {
        margin-bottom: 4rem;
    }

        .blog-pagination > .btn {
            border-radius: 2rem;
        }

    /*
    * Blog posts
    */
    .blog-post {
        margin-bottom: 4rem;
    }

    .blog-post-title {
        margin-bottom: .25rem;
        font-size: 2.5rem;
    }

    .blog-post-meta {
        margin-bottom: 1.25rem;
        color: #999;
    }

    /*
    * Footer
    */
    .blog-footer {
        padding: 2.5rem 0;
        color: #999;
        text-align: center;
        background-color: #f9f9f9;
        border-top: .05rem solid #e5e5e5;
    }

        .blog-footer p:last-child {
            margin-bottom: 0;
        }

    .bg-cover {
        background-image: url('/Images/laptop-3174729_1280x800.jpg');
        background-size: cover;
    }
</style>
@*<style>

        /* Always set the map height explicitly to define the size of the div
             * element that contains the map. */
        #map {
            height: 450px;
            width: 100%;
            padding: 0px;
            margin: 0px;
            border: 2px solid transparent;
        }

        .parentMap {
            position: relative;
            width: 100%;
        }

        .geocoder {
            position: absolute;
            z-index: 1;
            width: 50%;
            left: 50%;
            margin-left: -25%;
            top: 20px;
        }

        .mapboxgl-ctrl-geocoder {
            min-width: 100%;
        }

        .info {
            position: absolute;
            z-index: 1;
            width: 50%;
            left: 50%;
            margin-left: -25%;
            bottom: 35px;
            visibility: hidden;
        }

            .info div {
                background: #fff;
                padding: 10px;
                border-radius: 3px;
            }

        .card {
            margin-bottom: 15px !important
        }
    </style>*@

<div class="container">

    <div class="jumbotron p-4 p-md-5 text-white rounded bg-cover">
        <div class="offset-md-6 col-md-6 px-0 text-sm-right">
            <h1 class="display-4 font-italic">Conseil et expertise technologiques</h1>
            <p class="lead my-3">Notre entreprise propose d'accompagner vos projets informatiques et de répondre à vos attentes par des solutions sur-mesure.</p>
            <p class="lead mb-0"><a href="/home/contact" class="text-white font-weight-bold">Nous contacter ...</a></p>
        </div>
    </div>

</div>

<div class="container">

    <h1 style="text-align:center">
        <span>@ViewData["Title"]</span>
    </h1>

    <div class="card-deck">

        <div class="row" style="margin:0px">
            <div class="card" style="margin-bottom: 10px">
                <img class="card-img-top" src="~/Images/accounting-3190208_640.jpg" alt="Courtage informatique">
                <div class="card-body">
                    <h5 class="card-title">Achat</h5>
                    <p class="card-text">Nous vous accompagnons dans l'acquisition de vos équipements et logiciels informatiques.</p>
                    <p class="card-text">A partir de votre besoin, nous sélectionnons ensemble les propositions. Puis, nous négocions pour vous les conditions tarifaires.</p>
                </div>
                <div class="card-footer text-right">
                    <small class="text-muted"><label style="font-weight:bold;font-style: italic;font-size-adjust:1.1">Sur devis<sup><abbr title="@fraisInclus"> (1)</abbr></sup></label></small>
                </div>
            </div>
            <div class="card" style="margin-bottom: 10px">
                <img class="card-img-top" src="~/Images/web-design-2038872_640x423.jpg" alt="Ingénierie logicielle">
                <div class="card-body">
                    <h5 class="card-title" style="">Développement</h5>
                        <p class="card-text">Nous réalisons des applications et des sites WEB uniques.</p>
                        <p class="card-text">Après une étude de vos objectifs, nous concevons ensemble des interfaces dédiées pour mieux répondre à vos attentes.</p>
                </div>
                <div class="card-footer text-right">
                    <small class="text-muted"><label style="font-weight:bold;font-style: italic;font-size-adjust:1.1">400 euros<sup><abbr title="@tvaNonApplicable"> (2)</abbr></sup> / jour</label></small>
                </div>
            </div>
            <div class="card" style="margin-bottom: 10px">
                <img class="card-img-top" src="~/Images/software-development-4165307_640.jpg" alt="Formation personnalisée">
                <div class="card-body">
                    <h5 class="card-title">Formation</h5>
                        <p class="card-text">Nous vous enseignons à devenir autonome sur vos outils informatiques.</p>
                        <p class="card-text">Selon vos cas d'utilisation, nous créons un programme adéquate qui vous permettra d'utiliser vos équipements sans aide.</p>
                </div>
                <div class="card-footer text-right">
                    <small class="text-muted"><label style="font-weight:bold;font-style: italic;font-size-adjust:1.1">120 euros<sup><abbr title="@tvaNonApplicable"> (2)</abbr></sup> / heure</label></small>
                </div>
            </div>
        </div>

        <div class="row" style="margin:0px">
            <div class="card" style="margin-bottom: 10px">
                <img class="card-img-top" src="~/Images/computer-3343887_640x423.jpg" alt="Assistance adaptée">
                <div class="card-body">
                    <h5 class="card-title">Assistance</h5>
                        <p class="card-text">Nous vous aidons à résoudre vos problèmes informatiques.</p>
                        <p class="card-text">Après analyse des difficultés que vous rencontrez, nous déterminons ensemble la meilleure solution.</p>
                </div>
                <div class="card-footer text-right">
                    <small class="text-muted"><label style="font-weight:bold;font-style: italic;font-size-adjust:1.1">50 euros<sup><abbr title="@tvaNonApplicable"> (2)</abbr></sup> / heure</label></small>
                </div>
            </div>
            <div class="card" style="margin-bottom: 10px">
                <img class="card-img-top" src="~/Images/application-3399516_640x423.jpg" alt="Gestion de projet">
                <div class="card-body">
                    <h5 class="card-title">Conseil</h5>
                        <p class="card-text">Nous proposons également des services personnalisés.</p>
                        <p class="card-text">Vous avez un autre besoin, nous pouvons vous guider dans la réalisation de votre projet.</p>
                </div>
                <div class="card-footer text-right">
                    <small class="text-muted"><label style="font-weight:bold;font-style: italic;font-size-adjust:1.1">Sur devis<sup><abbr title="@fraisInclus"> (1)</abbr></sup></label></small>
                </div>
            </div>
            <div class="card border-0" style="margin-bottom: 10px">
                <div class="card-body">
                        <ul style="list-style:none;padding-left:0;">
                            <li class="card-text" style="font-style: italic"><small class="text-muted">(1) @fraisInclus</small></li>
                            <li  class="card-text"style="font-style: italic"><small class="text-muted">(2) @tvaNonApplicable</small></li>
                        </ul>
                </div>
            </div>
        </div>
    </div>

</div>

@section Scripts
{

    <script type="text/javascript">

        accessToken = 'pk.eyJ1IjoibmFvcHJvIiwiYSI6ImNrMTlyYmVzbjAxOGQzbnBpdmhrbnl2YmEifQ.qpxklqHmxVQEYXpGsrO09Q';
        var map;
        var popup;
        var infoWindow;

        $(document).ready(function () {

            initMap();

            //var info = document.getElementById('info');
            //info.innerHTML = '<strong>Click a marker ... .... .... .... .... .... ....</strong>';

        });

        function isInPolygon(point) {

            $.getJSON("/polygon-saint-gregoire.json", function (city) {
                var coords = [];
                $.each(city.coords, function (i, value) {
                    coords[i] = [value.lng, value.lat];
                });

                var pt = turf.point(point);
                var poly = turf.polygon([coords]);
                var info = document.getElementById('info');

                if (turf.booleanPointInPolygon(pt, poly)) {

                    info.firstElementChild.innerHTML = "Cette adresse est couverte";
                    info.firstElementChild.style.color = 'green';

                } else {

                    info.firstElementChild.innerHTML = "Cette adresse n'est pas couverte";
                    info.firstElementChild.style.color = 'red';

                }

                info.firstElementChild.style.visibility = 'visible';

            });



        }

        function initMap() {

            $.getJSON("/polygon-saint-gregoire.json", function (city) {

                var coords = [];

                $.each(city.coords, function (i, value) {
                    coords[i] = [value.lng, value.lat];
                });

                mapboxgl.accessToken = accessToken;
                map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v11',
                    center: [city.center.lng, city.center.lat + 0.004],
                    zoom: 11.7
                });

                map.on('load', function () {

                    map.addLayer({
                        'id': 'saintGregoireSurface',
                        'type': 'fill',
                        'source': {
                            'type': 'geojson',
                            'data': {
                                'type': 'Feature',
                                'geometry': {
                                    'type': 'Polygon',
                                    'coordinates': [coords]
                                }
                            }
                        },
                        'layout': {},
                        'paint': {
                            'fill-outline-color': 'rgba(200, 200, 200, 1)',
                            'fill-color': '#FF0000',
                            'fill-opacity': 0.1
                        }
                    });

                    map.addLayer({
                        "id": "saintGregoirePerimeter",
                        "type": "line",
                        "source": {
                            "type": "geojson",
                            "data": {
                                "type": "Feature",
                                "properties": {},
                                "geometry": {
                                    "type": "LineString",
                                    "coordinates": coords
                                }
                            }
                        },
                        "layout": {
                            "line-join": "round",
                            "line-cap": "round"
                        },
                        "paint": {
                            "line-color": "#FF0000",
                            "line-width": 0.8
                        }
                    });

                });

                var geocoder = new MapboxGeocoder({
                    accessToken: mapboxgl.accessToken,
                    placeholder: 'Saisissez votre adresse ...',
                    mapboxgl: mapboxgl,
                    proximity: { longitude: city.center.lng, latitude: city.center.lat } // Coordinates of Saint-Grégoire (35760)
                });

                document.getElementById('geocoder').appendChild(geocoder.onAdd(map));

                // Add zoom and rotation controls to the map.
                map.addControl(new mapboxgl.NavigationControl());

                $('.mapboxgl-ctrl-geocoder--input').on('keyup', function (e) {

                    if (e != null & e.currentTarget != null && e.currentTarget.value != null && e.currentTarget.value.length == 0) {
                        document.getElementById('info').firstElementChild.innerHTML = '';
                        document.getElementById('info').firstElementChild.style.visibility = 'hidden';
                    }

                });

                $('.mapboxgl-ctrl-geocoder--button').on('click', function () {
                    document.getElementById('info').firstElementChild.innerHTML = '';
                    document.getElementById('info').firstElementChild.style.visibility = 'hidden';
                });

                // Listen for the `result` event from the Geocoder
                // `result` event is triggered when a user makes a selection
                //  Add a marker at the result's coordinates
                geocoder.on('result', function (e) {

                    map.flyTo({ center: e.result.center });
                    isInPolygon(e.result.center);

                });



            });

        }

    </script>

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.4.0/mapbox-gl.js'></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.4.2/mapbox-gl-geocoder.min.js'></script>
    <!-- Promise polyfill script required to use Mapbox GL Geocoder in IE 11 -->
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>
    <script src='https://npmcdn.com/@@turf/turf/turf.min.js'></script>


}
